rule SUSP_ThemeBleed_Theme_Sep23 {
    meta:
        author = "@m_haggis, @nas_bench"
        description = "Detects domain or IP placement in Windows theme files"
        date = "2023-09-13"
        reference = "https://github.com/gabe-k/themebleed"
        reference = "https://exploits.forsale/themebleed"

    strings:
        $section = "[VisualStyles]"
        $path = /Path=\\\\[0-9a-zA-Z\.-]{1,13}\\/
        $theme1 = "[Theme]"

    condition:
        filesize < 1MB and all of them
}

rule EXPL_CVE_2021_31166_Accept_Encoding_May21_1 {
   meta:
      description = "Detects malformed Accept-Encoding header field as used in code exploiting CVE-2021-31166"
      author = "Florian Roth"
      reference = "https://github.com/0vercl0k/CVE-2021-31166"
      license = "https://creativecommons.org/licenses/by-nc/4.0/"
      date = "2021-05-21"
      score = 70
   strings:
      $xr1 = /[Aa]ccept\-[Ee]ncoding: [a-z\-]{1,16}, [a-z\-]{1,16}, [a-z\-]{1,16}, ,/
   condition:
      1 of them
}
